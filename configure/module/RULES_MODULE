.PHONY: db
db: conf
	$(QUIET) $(E3_MODULE_MAKE_CMDS) db

.PHONY: hdrs
hdrs:
#	$(SUDO) install -m 755 -d $(E3_MODULES_INSTALL_LOCATION_INC)/pv
#	cd $(E3_MODULES_INSTALL_LOCATION_INC) && $(SUDO) mv *.h pv/

# There is also an `epics` target that can be used to build the
# module as a standard EPICS module, that can be used like
#
#     .PHONY: epics
#     epics:
#     	$(QUIET)echo "EPICS_BASE := $(EPICS_BASE)"        >  $(TOP)/$(E3_MODULE_SRC_PATH)/configure/RELEASE
#     	$(QUIET)echo "ASYN := $(M_ASYN)"                  >  $(TOP)/$(E3_MODULE_SRC_PATH)/configure/RELEASE
#     	$(QUIET)echo "SSCAN := $(M_SSCAN)"                >> $(TOP)/$(E3_MODULE_SRC_PATH)/configure/RELEASE
#     	$(QUIET)echo "SNCSEQ := $(M_SNCSEQ)"              >> $(TOP)/$(E3_MODULE_SRC_PATH)/configure/RELEASE
#     	$(QUIET)echo "CHECK_RELEASE := YES"               >  $(TOP)/$(E3_MODULE_SRC_PATH)/configure/CONFIG_SITE
#     	$(QUIET)echo "INSTALL_LOCATION := $(M_DEVLIB2)"   >> $(TOP)/$(E3_MODULE_SRC_PATH)/configure/CONFIG_SITE
#     	$(SUDOBASH) "$(MAKE) -C $(E3_MODULE_SRC_PATH)"

# Local FREIA additions

OPIS_HOME = /opt/epics/OPIS
OPI_DIR = /opt/epics/opi/bob
LINK_DIR = ../../OPIS

.PHONY: opiinstall	## Install the OPIs
opiinstall:
	rsync -va --exclude 'README.md' $(TOP)/opi/ $(OPIS_HOME)/$(E3_MODULE_NAME)/$(OPI_VERSION)/
	cd $(OPI_DIR); rm -f $(OPI_DIRNAME); ln -s $(LINK_DIR)/$(E3_MODULE_NAME)/$(OPI_VERSION)/ $(OPI_DIRNAME)

.PHONY: calibration-CM01  ## Create CERNOX calibration data for CM01
calibration-CM01 : ./calibrations/CM01/*.fic ./calibrations/*.fic ../tools/ficFileConv
	../tools/ficFileConv CM01
	../tools/ficFileConv
.PHONY: calibration-CM02  ## Create CERNOX calibration data for CM02
calibration-CM02 : ./calibrations/CM02/*.fic ./calibrations/*.fic ../tools/ficFileConv
	../tools/ficFileConv CM02
	../tools/ficFileConv
.PHONY: calibration-CM03  ## Create CERNOX calibration data for CM03
calibration-CM03 : ./calibrations/CM03/*.fic ./calibrations/*.fic ../tools/ficFileConv
	../tools/ficFileConv CM03
	../tools/ficFileConv
.PHONY: calibration-CM04  ## Create CERNOX calibration data for CM04
calibration-CM04 : ./calibrations/CM04/*.fic ./calibrations/*.fic ../tools/ficFileConv
	../tools/ficFileConv CM04
	../tools/ficFileConv
.PHONY: calibration-CM05  ## Create CERNOX calibration data for CM05
calibration-CM05 : ./calibrations/CM05/*.fic ./calibrations/*.fic ../tools/ficFileConv
	../tools/ficFileConv CM05
	../tools/ficFileConv
.PHONY: calibration-CM06  ## Create CERNOX calibration data for CM06
calibration-CM06 : ./calibrations/CM06/*.fic ./calibrations/*.fic ../tools/ficFileConv
	../tools/ficFileConv CM06
	../tools/ficFileConv
.PHONY: calibration-CM07  ## Create CERNOX calibration data for CM07
calibration-CM07 : ./calibrations/CM07/*.fic ./calibrations/*.fic ../tools/ficFileConv
	../tools/ficFileConv CM07
	../tools/ficFileConv
.PHONY: calibration-CM08  ## Create CERNOX calibration data for CM08
calibration-CM08 : ./calibrations/CM08/*.fic ./calibrations/*.fic ../tools/ficFileConv
	../tools/ficFileConv CM08
	../tools/ficFileConv
.PHONY: calibration-CM09  ## Create CERNOX calibration data for CM09
calibration-CM09 : ./calibrations/CM09/*.fic ./calibrations/*.fic ../tools/ficFileConv
	../tools/ficFileConv CM09
	../tools/ficFileConv
.PHONY: calibration-CM010  ## Create CERNOX calibration data for CM001
calibration-CM10 : ./calibrations/CM10/*.fic ./calibrations/*.fic ../tools/ficFileConv
	../tools/ficFileConv CM10
	../tools/ficFileConv
.PHONY: calibration-CM011  ## Create CERNOX calibration data for CM011
calibration-CM11 : ./calibrations/CM11/*.fic ./calibrations/*.fic ../tools/ficFileConv
	../tools/ficFileConv CM11
	../tools/ficFileConv

